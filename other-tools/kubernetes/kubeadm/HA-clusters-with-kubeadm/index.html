<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="NERC Documentation"><meta name=author content=NERC><link href=https://nerc-project.github.io/nerc-docs/other-tools/kubernetes/kubeadm/HA-clusters-with-kubeadm/ rel=canonical><link href=../single-master-clusters-with-kubeadm/ rel=prev><link href=../../kubespray/ rel=next><link rel=icon href=../../../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>New England Research Cloud(NERC)</title><link rel=stylesheet href=../../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#highly-available-kubernetes-cluster-using-kubeadm class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <div class=parent> <div class=maintain> <div> Upcoming NERC system maintenance and upgrade </div> <div> (Tuesday, March 10, 2026 8:00 AM - 5:00 PM) <a style="color: #00efff" href=https://nerc.mghpcc.org/event/nerc-system-maintenance-20260310/ target=_blank>[Event Details]</a> </div> </div> <!-- <div class="upgrade">
    </div> --> <div class=child> <iframe src=https://nerc.instatus.com/embed-status/light-sm width=230 height=52 frameborder=0 scrolling=no style="border: none"></iframe> </div> </div> </div> </aside> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="NERC Documentation" class="md-header__button md-logo" aria-label="NERC Documentation" data-md-component=logo> <img src=../../../../assets/images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> NERC Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Creating a HA cluster with kubeadm </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/nerc-project/nerc-docs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> nerc-project/nerc-docs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="NERC Documentation" class="md-nav__button md-logo" aria-label="NERC Documentation" data-md-component=logo> <img src=../../../../assets/images/logo.png alt=logo> </a> NERC Documentation </label> <div class=md-nav__source> <a href=https://github.com/nerc-project/nerc-docs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> nerc-project/nerc-docs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../../get-started/ class="md-nav__link "> <span class=md-ellipsis> Getting Started </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Cost &amp; Billing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Cost &amp; Billing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/how-pricing-works/ class=md-nav__link> <span class=md-ellipsis> How does NERC pricing work? </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/pricing-for-bare-metal-machines/ class=md-nav__link> <span class=md-ellipsis> Pricing for Bare Metal Machines on NERC </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/nerc-pricing-calculator/ class=md-nav__link> <span class=md-ellipsis> NERC Pricing Calculator </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Billing Process </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Billing Process </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/billing-process-for-my-institution/ class=md-nav__link> <span class=md-ellipsis> Billing Process for My Institution </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/billing-process-for-harvard/ class=md-nav__link> <span class=md-ellipsis> Billing Process for Harvard University </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/billing-process-for-bu/ class=md-nav__link> <span class=md-ellipsis> Billing Process for Boston University </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../get-started/cost-billing/billing-faqs/ class=md-nav__link> <span class=md-ellipsis> Billing FAQs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../get-started/user-onboarding-on-NERC/ class=md-nav__link> <span class=md-ellipsis> User Onboarding Process </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/create-a-user-portal-account/ class=md-nav__link> <span class=md-ellipsis> How to Create a User Account </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> How to Get An Allocation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> How to Get An Allocation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../get-started/allocation/coldfront/ class=md-nav__link> <span class=md-ellipsis> What is NERC's ColdFront? </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/adding-a-project/ class=md-nav__link> <span class=md-ellipsis> A New Project Creation Process </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/manage-users-to-a-project/ class=md-nav__link> <span class=md-ellipsis> Managing Users in the Project </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/requesting-an-allocation/ class=md-nav__link> <span class=md-ellipsis> How to request a new Resource Allocation </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/allocation-change-request/ class=md-nav__link> <span class=md-ellipsis> Request change to Resource Allocation to an existing project </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/adding-a-new-allocation/ class=md-nav__link> <span class=md-ellipsis> Adding a new Resource Allocation to the project </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/managing-users-to-an-allocation/ class=md-nav__link> <span class=md-ellipsis> Managing Users in the Project Resource Allocation </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/project-and-allocation-review/ class=md-nav__link> <span class=md-ellipsis> Project and Individual Allocation Annual Review Process </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/archiving-a-project/ class=md-nav__link> <span class=md-ellipsis> Archiving an Existing Project </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/allocation/allocation-details/ class=md-nav__link> <span class=md-ellipsis> Allocation details </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Security Best Practices for the NERC Users </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Security Best Practices for the NERC Users </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../get-started/best-practices/best-practices/ class=md-nav__link> <span class=md-ellipsis> Quick Guide and Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/best-practices/best-practices-for-my-institution/ class=md-nav__link> <span class=md-ellipsis> Best Practices for My Institution </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/best-practices/best-practices-for-harvard/ class=md-nav__link> <span class=md-ellipsis> Best Practices for Harvard University </span> </a> </li> <li class=md-nav__item> <a href=../../../../get-started/best-practices/best-practices-for-bu/ class=md-nav__link> <span class=md-ellipsis> Best Practices for Boston University </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../../openstack/ class="md-nav__link "> <span class=md-ellipsis> OpenStack </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> OpenStack </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Logging In </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Logging In </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/logging-in/access-the-openstack-dashboard/ class=md-nav__link> <span class=md-ellipsis> Access the OpenStack Dashboard </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/logging-in/dashboard-overview/ class=md-nav__link> <span class=md-ellipsis> Dashboard Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> Access and Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Access and Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/access-and-security/security-groups/ class=md-nav__link> <span class=md-ellipsis> Security Groups </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/access-and-security/create-a-key-pair/ class=md-nav__link> <span class=md-ellipsis> Create a Key Pair </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Create &amp; Connect to the VM </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Create &amp; Connect to the VM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/launch-a-VM/ class=md-nav__link> <span class=md-ellipsis> Launch a VM </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/create-a-Windows-VM/ class=md-nav__link> <span class=md-ellipsis> Create a Windows VM </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/images/ class=md-nav__link> <span class=md-ellipsis> Available Images </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/flavors/ class=md-nav__link> <span class=md-ellipsis> Available NOVA Flavors </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/assign-a-floating-IP/ class=md-nav__link> <span class=md-ellipsis> Assign a Floating IP </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4_6> <div class="md-nav__link md-nav__container"> <a href=../../../../openstack/create-and-connect-to-the-VM/bastion-host-based-ssh/ class="md-nav__link "> <span class=md-ellipsis> Connect to the VM </span> </a> <label class="md-nav__link " for=__nav_4_4_6 id=__nav_4_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4_6> <span class="md-nav__icon md-icon"></span> Connect to the VM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/ssh-to-the-VM/ class=md-nav__link> <span class=md-ellipsis> SSH to the VM </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4_6_3> <div class="md-nav__link md-nav__container"> <a href=../../../../openstack/create-and-connect-to-the-VM/using-vpn/wireguard/ class="md-nav__link "> <span class=md-ellipsis> Using VPN </span> </a> <label class="md-nav__link " for=__nav_4_4_6_3 id=__nav_4_4_6_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_4_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4_6_3> <span class="md-nav__icon md-icon"></span> Using VPN </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4_6_3_1> <div class="md-nav__link md-nav__container"> <a href=../../../../openstack/create-and-connect-to-the-VM/using-vpn/openvpn/ class="md-nav__link "> <span class=md-ellipsis> OpenVPN </span> </a> <label class="md-nav__link " for=__nav_4_4_6_3_1 id=__nav_4_4_6_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_4_4_6_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4_6_3_1> <span class="md-nav__icon md-icon"></span> OpenVPN </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/using-vpn/openvpn/openvpn_gui_for_windows/ class=md-nav__link> <span class=md-ellipsis> OpenVPN GUI for Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/using-vpn/openvpn/tunnelblick_for_macos/ class=md-nav__link> <span class=md-ellipsis> Tunnelblick for MacOS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openstack/create-and-connect-to-the-VM/using-vpn/sshuttle/ class=md-nav__link> <span class=md-ellipsis> sshuttle </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> OpenStack CLI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> OpenStack CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/openstack-cli/openstack-CLI/ class=md-nav__link> <span class=md-ellipsis> OpenStack CLI </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/openstack-cli/launch-a-VM-using-openstack-CLI/ class=md-nav__link> <span class=md-ellipsis> Launch a VM using OpenStack CLI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class=md-ellipsis> Persistent Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Persistent Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_1> <label class=md-nav__link for=__nav_4_6_1 id=__nav_4_6_1_label tabindex=0> <span class=md-ellipsis> Block Storage/ Volumes/ Cinder </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_1> <span class="md-nav__icon md-icon"></span> Block Storage/ Volumes/ Cinder </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/volumes/ class=md-nav__link> <span class=md-ellipsis> Block Storage/ Volumes/ Cinder </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/create-an-empty-volume/ class=md-nav__link> <span class=md-ellipsis> Create An Empty Volume </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/attach-the-volume-to-an-instance/ class=md-nav__link> <span class=md-ellipsis> Attach The Volume To An Instance </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/format-and-mount-the-volume/ class=md-nav__link> <span class=md-ellipsis> Format And Mount The Volume </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/detach-a-volume/ class=md-nav__link> <span class=md-ellipsis> Detach a Volume </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/delete-volumes/ class=md-nav__link> <span class=md-ellipsis> Delete Volumes </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/extending-volume/ class=md-nav__link> <span class=md-ellipsis> Extending Volume </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/transfer-a-volume/ class=md-nav__link> <span class=md-ellipsis> Transfer a Volume </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_2> <label class=md-nav__link for=__nav_4_6_2 id=__nav_4_6_2_label tabindex=0> <span class=md-ellipsis> Object Storage/ Swift </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_2> <span class="md-nav__icon md-icon"></span> Object Storage/ Swift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/object-storage/ class=md-nav__link> <span class=md-ellipsis> Object Storage/ Swift </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/persistent-storage/mount-the-object-storage/ class=md-nav__link> <span class=md-ellipsis> Mount The Object Storage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openstack/data-transfer/data-transfer-from-to-vm/ class=md-nav__link> <span class=md-ellipsis> Data Transfer </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/backup/backup-with-snapshots/ class=md-nav__link> <span class=md-ellipsis> Backup your instance &amp; data </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/management/vm-management/ class=md-nav__link> <span class=md-ellipsis> VM Management </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/decommission/decommission-openstack-resources/ class=md-nav__link> <span class=md-ellipsis> Decommission your OpenStack Resources </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11> <label class=md-nav__link for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class=md-ellipsis> Advanced Topics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> Advanced Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_1> <label class=md-nav__link for=__nav_4_11_1 id=__nav_4_11_1_label tabindex=0> <span class=md-ellipsis> Setting Up Own Network </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_1> <span class="md-nav__icon md-icon"></span> Setting Up Own Network </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/setting-up-a-network/set-up-a-private-network/ class=md-nav__link> <span class=md-ellipsis> Set up a Private Network </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/setting-up-a-network/create-a-router/ class=md-nav__link> <span class=md-ellipsis> Create a Router </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_2> <label class=md-nav__link for=__nav_4_11_2 id=__nav_4_11_2_label tabindex=0> <span class=md-ellipsis> Domain Name System </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_2> <span class="md-nav__icon md-icon"></span> Domain Name System </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/domain-name-system/domain-names-for-your-vms/ class=md-nav__link> <span class=md-ellipsis> Set up Domain names for your VMs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_3> <label class=md-nav__link for=__nav_4_11_3 id=__nav_4_11_3_label tabindex=0> <span class=md-ellipsis> Terraform </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_3> <span class="md-nav__icon md-icon"></span> Terraform </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/terraform/terraform-on-NERC/ class=md-nav__link> <span class=md-ellipsis> Terraform on NERC </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/python-sdk/python-SDK/ class=md-nav__link> <span class=md-ellipsis> Python SDK </span> </a> </li> <li class=md-nav__item> <a href=../../../../openstack/advanced-openstack-topics/setting-up-your-own-images/how-to-build-windows-image/ class=md-nav__link> <span class=md-ellipsis> Setting up custom images </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../openshift/ class="md-nav__link "> <span class=md-ellipsis> OpenShift </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> OpenShift </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> OpenShift Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> OpenShift Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/get-started/openshift-overview/ class=md-nav__link> <span class=md-ellipsis> OpenShift Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> OpenShift Web Console </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> OpenShift Web Console </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/logging-in/access-the-openshift-web-console/ class=md-nav__link> <span class=md-ellipsis> Access the NERC's OpenShift Web Console </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/logging-in/web-console-overview/ class=md-nav__link> <span class=md-ellipsis> Web Console Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> OpenShift command-line interface (CLI) Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> OpenShift command-line interface (CLI) Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/logging-in/the-openshift-cli/ class=md-nav__link> <span class=md-ellipsis> OpenShift CLI Tools Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/logging-in/setup-the-openshift-cli/ class=md-nav__link> <span class=md-ellipsis> How to Setup the OpenShift CLI Tools </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> Creating Your First Application on OpenShift </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Creating Your First Application on OpenShift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/applications/creating-a-sample-application/ class=md-nav__link> <span class=md-ellipsis> Creating A Sample Application </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/applications/creating-your-own-developer-catalog-service/ class=md-nav__link> <span class=md-ellipsis> Creating Your Own Developer Catalog Service </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> Editing Applications </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Editing Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/applications/editing-applications/ class=md-nav__link> <span class=md-ellipsis> Editing your applications </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/applications/scaling-and-performance-guide/ class=md-nav__link> <span class=md-ellipsis> Scaling and Performance Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> Serverless Computing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> Serverless Computing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/applications/understanding-openshift-serverless/ class=md-nav__link> <span class=md-ellipsis> Understanding OpenShift Serverless </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/applications/knative-serving/ class=md-nav__link> <span class=md-ellipsis> Knative Serving User Guide: Deploying and Managing Serverless Workloads </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openshift/domain-name-system/domain-name-for-your-application/ class=md-nav__link> <span class=md-ellipsis> Set up Domain Name for Your Application </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9 id=__nav_5_9_label tabindex=0> <span class=md-ellipsis> GPUs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_9_label aria-expanded=false> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> GPUs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/gpus/intro-to-gpus-on-nerc-ocp/ class=md-nav__link> <span class=md-ellipsis> Introduction to GPUs on NERC OpenShift </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_10> <label class=md-nav__link for=__nav_5_10 id=__nav_5_10_label tabindex=0> <span class=md-ellipsis> Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_10_label aria-expanded=false> <label class=md-nav__title for=__nav_5_10> <span class="md-nav__icon md-icon"></span> Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/storage/storage-overview/ class=md-nav__link> <span class=md-ellipsis> Storage Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/storage/minio/ class=md-nav__link> <span class=md-ellipsis> Minio </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift/storage/Rclone/ class=md-nav__link> <span class=md-ellipsis> Rclone </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_11> <label class=md-nav__link for=__nav_5_11 id=__nav_5_11_label tabindex=0> <span class=md-ellipsis> Deleting Applications </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_11_label aria-expanded=false> <label class=md-nav__title for=__nav_5_11> <span class="md-nav__icon md-icon"></span> Deleting Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift/applications/deleting-applications/ class=md-nav__link> <span class=md-ellipsis> Deleting your applications </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openshift/decommission/decommission-openshift-resources/ class=md-nav__link> <span class=md-ellipsis> Decommission OpenShift Resources </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../../../openshift-ai/ class="md-nav__link "> <span class=md-ellipsis> Red Hat OpenShift AI (RHOAI) </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Red Hat OpenShift AI (RHOAI) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> NERC OpenShift AI Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> NERC OpenShift AI Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/get-started/rhoai-overview/ class=md-nav__link> <span class=md-ellipsis> NERC RHOAI Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> NERC OpenShift AI Dashboard </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> NERC OpenShift AI Dashboard </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/logging-in/access-the-rhoai-dashboard/ class=md-nav__link> <span class=md-ellipsis> Access the NERC's OpenShift AI dashboard </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/logging-in/the-rhoai-dashboard-overview/ class=md-nav__link> <span class=md-ellipsis> The NERC's OpenShift AI dashboard Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> <span class=md-ellipsis> Using Data Science Project in the NERC RHOAI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> Using Data Science Project in the NERC RHOAI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/data-science-project/using-projects-the-rhoai/ class=md-nav__link> <span class=md-ellipsis> Using Your Data Science Project (DSP) </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/data-science-project/explore-the-jupyterlab-environment/ class=md-nav__link> <span class=md-ellipsis> Explore the JupyterLab Environment </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/data-science-project/model-serving-in-the-rhoai/ class=md-nav__link> <span class=md-ellipsis> Model Serving in the NERC RHOAI </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/data-science-project/testing-model-in-the-rhoai/ class=md-nav__link> <span class=md-ellipsis> Test the Model in the NERC RHOAI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5> <label class=md-nav__link for=__nav_6_5 id=__nav_6_5_label tabindex=0> <span class=md-ellipsis> Other Example Projects </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> Other Example Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/how-access-s3-data-then-download-and-analyze-it/ class=md-nav__link> <span class=md-ellipsis> How to access, download, and analyze data for S3 usage </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/configure-jupyter-notebook-use-gpus-aiml-modeling/ class=md-nav__link> <span class=md-ellipsis> Configure a Jupyter Notebook to use GPUs for AI/ML modeling </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5_3> <label class=md-nav__link for=__nav_6_5_3 id=__nav_6_5_3_label tabindex=0> <span class=md-ellipsis> Predictive &amp; Generative AI on NERC </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5_3> <span class="md-nav__icon md-icon"></span> Predictive &amp; Generative AI on NERC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/predictive-and-generative-AI/ class=md-nav__link> <span class=md-ellipsis> Predictive &amp; Generative AI (LLM &amp; RAG) in Action </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5_3_2> <label class=md-nav__link for=__nav_6_5_3_2 id=__nav_6_5_3_2_label tabindex=0> <span class=md-ellipsis> Predictive AI tutorial </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_5_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5_3_2> <span class="md-nav__icon md-icon"></span> Predictive AI tutorial </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/fraud-detection-predictive-ai-app/ class=md-nav__link> <span class=md-ellipsis> Credit Card Fraud Detection Application </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/object-detection-app-using-yolo5/ class=md-nav__link> <span class=md-ellipsis> Object Detection Application Using YOLOv5 Model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5_3_3> <label class=md-nav__link for=__nav_6_5_3_3 id=__nav_6_5_3_3_label tabindex=0> <span class=md-ellipsis> Generative AI tutorial </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_5_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5_3_3> <span class="md-nav__icon md-icon"></span> Generative AI tutorial </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/LLM-chat/ class=md-nav__link> <span class=md-ellipsis> Large Language Model (LLM) - Chat </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/RAG-talk-with-your-pdf/ class=md-nav__link> <span class=md-ellipsis> Retrieval Augumented Generation (RAG) - Talk with your PDF </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/deploying-a-llama-model-with-kserve/ class=md-nav__link> <span class=md-ellipsis> Deploying a Llama model with KServe </span> </a> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/serving-tgis-and-FLAN-T5-Model/ class=md-nav__link> <span class=md-ellipsis> Serving Text Generation Inference Service (TGIS) and FLAN-T5 Small Model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../openshift-ai/other-projects/LLM-client-AnythingLLM/ class=md-nav__link> <span class=md-ellipsis> LLM Client - AnythingLLM </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <span class=md-ellipsis> Other Tools On NERC </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Other Tools On NERC </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2 checked> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class=md-ellipsis> Kubernetes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=true> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/ class=md-nav__link> <span class=md-ellipsis> Kubernetes Overview </span> </a> </li> <li class=md-nav__item> <a href=../../comparisons/ class=md-nav__link> <span class=md-ellipsis> K8s Flavors Comparision </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_3> <label class=md-nav__link for=__nav_7_2_3 id=__nav_7_2_3_label tabindex=0> <span class=md-ellipsis> Development environment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_3> <span class="md-nav__icon md-icon"></span> Development environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../minikube/ class=md-nav__link> <span class=md-ellipsis> Minikube </span> </a> </li> <li class=md-nav__item> <a href=../../kind/ class=md-nav__link> <span class=md-ellipsis> Kind </span> </a> </li> <li class=md-nav__item> <a href=../../microk8s/ class=md-nav__link> <span class=md-ellipsis> MicroK8s </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_3_4> <label class=md-nav__link for=__nav_7_2_3_4 id=__nav_7_2_3_4_label tabindex=0> <span class=md-ellipsis> K3s </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_3_4> <span class="md-nav__icon md-icon"></span> K3s </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../k3s/k3s/ class=md-nav__link> <span class=md-ellipsis> K3s </span> </a> </li> <li class=md-nav__item> <a href=../../k3s/k3s-ha-cluster/ class=md-nav__link> <span class=md-ellipsis> K3s with High Availibility(HA) setup </span> </a> </li> <li class=md-nav__item> <a href=../../k3s/k3s-using-k3sup/ class=md-nav__link> <span class=md-ellipsis> Multi-master HA K3s cluster using k3sup </span> </a> </li> <li class=md-nav__item> <a href=../../k3s/k3s-using-k3d/ class=md-nav__link> <span class=md-ellipsis> Single-Node K3s Cluster using k3d </span> </a> </li> <li class=md-nav__item> <a href=../../k3s/k3s-ha-cluster-using-k3d/ class=md-nav__link> <span class=md-ellipsis> Multi-master K3s cluster setup using k3d </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../k0s/ class=md-nav__link> <span class=md-ellipsis> k0s </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4 checked> <label class=md-nav__link for=__nav_7_2_4 id=__nav_7_2_4_label tabindex=0> <span class=md-ellipsis> Production environment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_4_label aria-expanded=true> <label class=md-nav__title for=__nav_7_2_4> <span class="md-nav__icon md-icon"></span> Production environment </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_1 checked> <label class=md-nav__link for=__nav_7_2_4_1 id=__nav_7_2_4_1_label tabindex=0> <span class=md-ellipsis> Kubeadm </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_1_label aria-expanded=true> <label class=md-nav__title for=__nav_7_2_4_1> <span class="md-nav__icon md-icon"></span> Kubeadm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../single-master-clusters-with-kubeadm/ class=md-nav__link> <span class=md-ellipsis> Bootstrapping cluster with kubeadm </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Creating a HA cluster with kubeadm </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Creating a HA cluster with kubeadm </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objectives class=md-nav__link> <span class=md-ellipsis> Objectives </span> </a> </li> <li class=md-nav__item> <a href=#components-and-architecure class=md-nav__link> <span class=md-ellipsis> Components and architecure </span> </a> </li> <li class=md-nav__item> <a href=#pre-requisite class=md-nav__link> <span class=md-ellipsis> Pre-requisite </span> </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> <span class=md-ellipsis> Steps </span> </a> </li> <li class=md-nav__item> <a href=#setting-up-loadbalancer class=md-nav__link> <span class=md-ellipsis> Setting up loadbalancer </span> </a> </li> <li class=md-nav__item> <a href=#install-kubeadm-kubelet-and-containerd-on-master-and-worker-nodes class=md-nav__link> <span class=md-ellipsis> Install kubeadm, kubelet and containerd on master and worker nodes </span> </a> </li> <li class=md-nav__item> <a href=#install-the-container-runtime-ie-containerd-on-master-and-worker-nodes class=md-nav__link> <span class=md-ellipsis> Install the container runtime i.e. containerd on master and worker nodes </span> </a> </li> <li class=md-nav__item> <a href=#configure-kubeadm-to-bootstrap-the-cluster class=md-nav__link> <span class=md-ellipsis> Configure kubeadm to bootstrap the cluster </span> </a> </li> <li class=md-nav__item> <a href=#configure-kubeconfig-on-loadbalancer-node class=md-nav__link> <span class=md-ellipsis> Configure kubeconfig on loadbalancer node </span> </a> </li> <li class=md-nav__item> <a href=#install-kubectl class=md-nav__link> <span class=md-ellipsis> Install kubectl </span> </a> </li> <li class=md-nav__item> <a href=#install-cni-network-plugin class=md-nav__link> <span class=md-ellipsis> Install CNI network plugin </span> </a> <nav class=md-nav aria-label="Install CNI network plugin"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cni-overview class=md-nav__link> <span class=md-ellipsis> CNI overview </span> </a> </li> <li class=md-nav__item> <a href=#supported-cni-options class=md-nav__link> <span class=md-ellipsis> Supported CNI options </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deploy-a-sample-nginx-application-from-one-of-the-master-nodes class=md-nav__link> <span class=md-ellipsis> Deploy A Sample Nginx Application From one of the master nodes </span> </a> </li> <li class=md-nav__item> <a href=#deploy-a-k8s-dashboard class=md-nav__link> <span class=md-ellipsis> Deploy A K8s Dashboard </span> </a> </li> <li class=md-nav__item> <a href=#watch-demo-video-showing-how-to-setup-the-cluster class=md-nav__link> <span class=md-ellipsis> Watch Demo Video showing how to setup the cluster </span> </a> </li> <li class=md-nav__item> <a href=#very-important-certificates-renewal class=md-nav__link> <span class=md-ellipsis> Very Important: Certificates Renewal </span> </a> </li> <li class=md-nav__item> <a href=#clean-up class=md-nav__link> <span class=md-ellipsis> Clean Up </span> </a> <nav class=md-nav aria-label="Clean Up"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-remove-the-node class=md-nav__link> <span class=md-ellipsis> How to Remove the node? </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../kubespray/ class=md-nav__link> <span class=md-ellipsis> Kubespray </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class=md-ellipsis> CI/CD Pipeline </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> CI/CD Pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CI-CD/CI-CD-pipeline/ class=md-nav__link> <span class=md-ellipsis> CI/CD Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_2> <label class=md-nav__link for=__nav_7_3_2 id=__nav_7_3_2_label tabindex=0> <span class=md-ellipsis> Using Jenkins </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_2> <span class="md-nav__icon md-icon"></span> Using Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CI-CD/jenkins/setup-jenkins-CI-CD-pipeline/ class=md-nav__link> <span class=md-ellipsis> Setup Jenkins CI/CD Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../../CI-CD/jenkins/integrate-your-GitHub-repository/ class=md-nav__link> <span class=md-ellipsis> GitHub to Jenkins Pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_3> <label class=md-nav__link for=__nav_7_3_3 id=__nav_7_3_3_label tabindex=0> <span class=md-ellipsis> Using Github Actions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_3> <span class="md-nav__icon md-icon"></span> Using Github Actions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CI-CD/github-actions/setup-github-actions-pipeline/ class=md-nav__link> <span class=md-ellipsis> GitHub Actions CI/CD Pipeline </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_4> <label class=md-nav__link for=__nav_7_4 id=__nav_7_4_label tabindex=0> <span class=md-ellipsis> R </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_4> <span class="md-nav__icon md-icon"></span> R </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../R/rstudio-server/running-rstudio-on-NERC/ class=md-nav__link> <span class=md-ellipsis> RStudio </span> </a> </li> <li class=md-nav__item> <a href=../../../R/r-shiny-server/running-rshiny-on-NERC/ class=md-nav__link> <span class=md-ellipsis> R Shiny </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../apache-spark/spark/ class=md-nav__link> <span class=md-ellipsis> Apache Spark </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_6> <label class=md-nav__link for=__nav_7_6 id=__nav_7_6_label tabindex=0> <span class=md-ellipsis> MLflow </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_6> <span class="md-nav__icon md-icon"></span> MLflow </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../mlflow/mlflow-overview/ class=md-nav__link> <span class=md-ellipsis> MLflow Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../mlflow/mlflow-server-setup/ class=md-nav__link> <span class=md-ellipsis> MLflow Server Setup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../postgres/postgres-cluster-setup/ class=md-nav__link> <span class=md-ellipsis> PostgresSQL Cluster </span> </a> </li> <li class=md-nav__item> <a href=../../../nfs/nfs-server-client-setup/ class=md-nav__link> <span class=md-ellipsis> Setup NFS Server and Client </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objectives class=md-nav__link> <span class=md-ellipsis> Objectives </span> </a> </li> <li class=md-nav__item> <a href=#components-and-architecure class=md-nav__link> <span class=md-ellipsis> Components and architecure </span> </a> </li> <li class=md-nav__item> <a href=#pre-requisite class=md-nav__link> <span class=md-ellipsis> Pre-requisite </span> </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> <span class=md-ellipsis> Steps </span> </a> </li> <li class=md-nav__item> <a href=#setting-up-loadbalancer class=md-nav__link> <span class=md-ellipsis> Setting up loadbalancer </span> </a> </li> <li class=md-nav__item> <a href=#install-kubeadm-kubelet-and-containerd-on-master-and-worker-nodes class=md-nav__link> <span class=md-ellipsis> Install kubeadm, kubelet and containerd on master and worker nodes </span> </a> </li> <li class=md-nav__item> <a href=#install-the-container-runtime-ie-containerd-on-master-and-worker-nodes class=md-nav__link> <span class=md-ellipsis> Install the container runtime i.e. containerd on master and worker nodes </span> </a> </li> <li class=md-nav__item> <a href=#configure-kubeadm-to-bootstrap-the-cluster class=md-nav__link> <span class=md-ellipsis> Configure kubeadm to bootstrap the cluster </span> </a> </li> <li class=md-nav__item> <a href=#configure-kubeconfig-on-loadbalancer-node class=md-nav__link> <span class=md-ellipsis> Configure kubeconfig on loadbalancer node </span> </a> </li> <li class=md-nav__item> <a href=#install-kubectl class=md-nav__link> <span class=md-ellipsis> Install kubectl </span> </a> </li> <li class=md-nav__item> <a href=#install-cni-network-plugin class=md-nav__link> <span class=md-ellipsis> Install CNI network plugin </span> </a> <nav class=md-nav aria-label="Install CNI network plugin"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cni-overview class=md-nav__link> <span class=md-ellipsis> CNI overview </span> </a> </li> <li class=md-nav__item> <a href=#supported-cni-options class=md-nav__link> <span class=md-ellipsis> Supported CNI options </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deploy-a-sample-nginx-application-from-one-of-the-master-nodes class=md-nav__link> <span class=md-ellipsis> Deploy A Sample Nginx Application From one of the master nodes </span> </a> </li> <li class=md-nav__item> <a href=#deploy-a-k8s-dashboard class=md-nav__link> <span class=md-ellipsis> Deploy A K8s Dashboard </span> </a> </li> <li class=md-nav__item> <a href=#watch-demo-video-showing-how-to-setup-the-cluster class=md-nav__link> <span class=md-ellipsis> Watch Demo Video showing how to setup the cluster </span> </a> </li> <li class=md-nav__item> <a href=#very-important-certificates-renewal class=md-nav__link> <span class=md-ellipsis> Very Important: Certificates Renewal </span> </a> </li> <li class=md-nav__item> <a href=#clean-up class=md-nav__link> <span class=md-ellipsis> Clean Up </span> </a> <nav class=md-nav aria-label="Clean Up"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-remove-the-node class=md-nav__link> <span class=md-ellipsis> How to Remove the node? </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../../../.. class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../../../ class=md-path__link> <span class=md-ellipsis> Other Tools On NERC </span> </a> </li> <li class=md-path__item> <a href=../../kubernetes/ class=md-path__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> <li class=md-path__item> <a href=../single-master-clusters-with-kubeadm/ class=md-path__link> <span class=md-ellipsis> Production environment </span> </a> </li> <li class=md-path__item> <a href=../single-master-clusters-with-kubeadm/ class=md-path__link> <span class=md-ellipsis> Kubeadm </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/nerc-project/nerc-docs/edit/main/docs/other-tools/kubernetes/kubeadm/HA-clusters-with-kubeadm.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <h1 id=highly-available-kubernetes-cluster-using-kubeadm>Highly Available Kubernetes Cluster using kubeadm</h1> <h2 id=objectives>Objectives</h2> <ul> <li> <p>Install a multi control-plane(master) Kubernetes cluster</p> </li> <li> <p>Install a Pod network on the cluster so that your Pods can talk to each other</p> </li> <li> <p>Deploy and test a sample app</p> </li> <li> <p>Deploy K8s Dashboard to view all cluster's components</p> </li> </ul> <h2 id=components-and-architecure>Components and architecure</h2> <p>This shows components and architecture of a highly-available, production-grade Kubernetes cluster.</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/k8s_HA_cluster.png data-desc-position=bottom><img alt="Components and architecure" src=../../images/k8s_HA_cluster.png></a></p> <p>You can learn about each component from <a href=https://kubernetes.io/docs/concepts/overview/components/ >Kubernetes Componets</a>.</p> <h2 id=pre-requisite>Pre-requisite</h2> <p>You will need 2 control-plane(master node) and 2 worker nodes to create a multi-master kubernetes cluster using <code>kubeadm</code>. You are going to use the following set up for this purpose:</p> <ul> <li> <p>2 Linux machines for master, <code>ubuntu-20.04-x86_64</code> or your choice of Ubuntu OS image, <code>cpu-su.2</code> flavor with 2vCPU, 8GB RAM, 20GB storage.</p> </li> <li> <p>2 Linux machines for worker, <code>ubuntu-20.04-x86_64</code> or your choice of Ubuntu OS image, <code>cpu-su.1</code> flavor with 1vCPU, 4GB RAM, 20GB storage - also <a href=../../../../openstack/create-and-connect-to-the-VM/assign-a-floating-IP/ >assign Floating IPs</a> to both of the worker nodes.</p> </li> <li> <p>1 Linux machine for loadbalancer, <code>ubuntu-20.04-x86_64</code> or your choice of Ubuntu OS image, <code>cpu-su.1</code> flavor with 1vCPU, 4GB RAM, 20GB storage.</p> </li> <li> <p>ssh access to all machines: <a href=../../../../openstack/create-and-connect-to-the-VM/bastion-host-based-ssh/ >Read more here</a> on how to setup SSH to your remote VMs.</p> </li> <li> <p>Create 2 security groups with appropriate <a href=https://kubernetes.io/docs/reference/ports-and-protocols/ >ports and protocols</a>:</p> </li> </ul> <p>i. To be used by the master nodes:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/control_plane_ports_protocols.png data-desc-position=bottom><img alt="Control plane ports and protocols" src=../../images/control_plane_ports_protocols.png></a></p> <p>ii. To be used by the worker nodes:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/worker_nodes_ports_protocols.png data-desc-position=bottom><img alt="Worker node ports and protocols" src=../../images/worker_nodes_ports_protocols.png></a></p> <ul> <li> <p>setup Unique hostname to each machine using the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nb>echo</span><span class=w> </span><span class=s2>"&lt;node_internal_IP&gt; &lt;host_name&gt;"</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/hosts
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>hostnamectl<span class=w> </span>set-hostname<span class=w> </span>&lt;host_name&gt;
</span></code></pre></div> <p>For example:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>echo</span><span class=w> </span><span class=s2>"192.168.0.167 loadbalancer"</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/hosts
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>hostnamectl<span class=w> </span>set-hostname<span class=w> </span>loadbalancer
</span></code></pre></div> </li> </ul> <h2 id=steps>Steps</h2> <ol> <li> <p>Prepare the Loadbalancer node to communicate with the two master nodes' apiservers on their IPs via port 6443.</p> </li> <li> <p>Do following in all the nodes except the Loadbalancer node:</p> <ul> <li> <p>Disable swap.</p> </li> <li> <p>Install <code>kubelet</code> and <code>kubeadm</code>.</p> </li> <li> <p>Install container runtime - you will be using <em><code>containerd</code></em>.</p> </li> </ul> </li> <li> <p>Initiate <code>kubeadm</code> control plane configuration on one of the master nodes.</p> </li> <li> <p>Save the new master and worker node join commands with the token.</p> </li> <li> <p>Join the second master node to the control plane using the join command.</p> </li> <li> <p>Join the worker nodes to the control plane using the join command.</p> </li> <li> <p>Configure kubeconfig(<code>$HOME/.kube/config</code>) on loadbalancer node.</p> </li> <li> <p>Install <code>kubectl</code> on Loadbalancer node.</p> </li> <li> <p>Install CNI network plugin i.e. <strong>Flannel</strong> on Loadbalancer node.</p> </li> <li> <p>Validate all cluster components and nodes are visible on Loadbalancer node.</p> </li> <li> <p>Deploy a sample app and validate the app from Loadbalancer node.</p> </li> </ol> <hr> <h2 id=setting-up-loadbalancer>Setting up loadbalancer</h2> <p>You will use <strong>HAPROXY</strong> as the primary loadbalancer, but you can use any other options as well. This node will be not part of the K8s cluster but will be outside of the cluster and interacts with the cluster using ports.</p> <p>You have 2 master nodes. Which means the user can connect to either of the 2 apiservers. The loadbalancer will be used to loadbalance between the 2 apiservers.</p> <ul> <li> <p>Login to the loadbalancer node</p> </li> <li> <p>Switch as root - <code>sudo su</code></p> </li> <li> <p>Update your repository and your system</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>sudo<span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>sudo<span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y
</span></code></pre></div> </li> <li> <p>Install haproxy</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>haproxy<span class=w> </span>-y
</span></code></pre></div> </li> <li> <p>Edit haproxy configuration</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>vi<span class=w> </span>/etc/haproxy/haproxy.cfg
</span></code></pre></div> <p>Add the below lines to create a frontend configuration for loadbalancer -</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>frontend<span class=w> </span>fe-apiserver
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nb>bind</span><span class=w> </span><span class=m>0</span>.0.0.0:6443
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>mode<span class=w> </span>tcp
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>option<span class=w> </span>tcplog
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>default_backend<span class=w> </span>be-apiserver
</span></code></pre></div> <p>Add the below lines to create a backend configuration for master1 and master2 nodes at port <strong>6443</strong>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>6443 is the default port of <strong>kube-apiserver</strong></p> </div> <div class="language-sh highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>backend<span class=w> </span>be-apiserver
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>mode<span class=w> </span>tcp
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>option<span class=w> </span>tcplog
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>option<span class=w> </span>tcp-check
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>balance<span class=w> </span>roundrobin
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>default-server<span class=w> </span>inter<span class=w> </span>10s<span class=w> </span>downinter<span class=w> </span>5s<span class=w> </span>rise<span class=w> </span><span class=m>2</span><span class=w> </span>fall<span class=w> </span><span class=m>2</span><span class=w> </span>slowstart<span class=w> </span>60s<span class=w> </span>maxconn<span class=w> </span><span class=m>250</span><span class=w> </span>maxqueue<span class=w> </span><span class=m>256</span><span class=w> </span>weight<span class=w> </span><span class=m>100</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span>server<span class=w> </span>master1<span class=w> </span><span class=m>10</span>.138.0.15:6443<span class=w> </span>check
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span>server<span class=w> </span>master2<span class=w> </span><span class=m>10</span>.138.0.16:6443<span class=w> </span>check
</span></code></pre></div> <p>Here - <strong>master1</strong> and <strong>master2</strong> are the hostnames of the master nodes and <strong>10.138.0.15</strong> and <strong>10.138.0.16</strong> are the corresponding internal IP addresses.</p> </li> <li> <p>Ensure haproxy config file is correctly formatted:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>haproxy<span class=w> </span>-c<span class=w> </span>-q<span class=w> </span>-V<span class=w> </span>-f<span class=w> </span>/etc/haproxy/haproxy.cfg
</span></code></pre></div> </li> <li> <p>Restart and Verify haproxy</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>systemctl<span class=w> </span>restart<span class=w> </span>haproxy
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>systemctl<span class=w> </span>status<span class=w> </span>haproxy
</span></code></pre></div> <p>Ensure haproxy is in running status.</p> <p>Run <code>nc</code> command as below:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>nc<span class=w> </span>-v<span class=w> </span>localhost<span class=w> </span><span class=m>6443</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>Connection<span class=w> </span>to<span class=w> </span>localhost<span class=w> </span><span class=m>6443</span><span class=w> </span>port<span class=w> </span><span class=o>[</span>tcp/*<span class=o>]</span><span class=w> </span>succeeded!
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If you see failures for <code>master1</code> and <code>master2</code> connectivity, you can ignore them for time being as you have not yet installed anything on the servers.</p> </div> </li> </ul> <hr> <h2 id=install-kubeadm-kubelet-and-containerd-on-master-and-worker-nodes>Install kubeadm, kubelet and containerd on master and worker nodes</h2> <p><code>kubeadm</code> will not install or manage <code>kubelet</code> or <code>kubectl</code> for you, so you will need to ensure they match the version of the Kubernetes control plane you want kubeadm to install for you. You will install these packages on all of your machines:</p> <p> <strong>kubeadm</strong>: the command to bootstrap the cluster.</p> <p> <strong>kubelet</strong>: the component that runs on all of the machines in your cluster and does things like starting pods and containers.</p> <p> <strong>kubectl</strong>: the command line util to talk to your cluster.</p> <p>In this step, you will install kubelet and kubeadm on the below nodes</p> <ul> <li> <p>master1</p> </li> <li> <p>master2</p> </li> <li> <p>worker1</p> </li> <li> <p>worker2</p> </li> </ul> <p>The below steps will be performed on all the above mentioned nodes:</p> <ul> <li> <p>SSH into all the 4 machines</p> </li> <li> <p>Update the repositories and packages:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>sudo<span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>sudo<span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y
</span></code></pre></div> </li> <li> <p>Turn off <code>swap</code></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>swapoff<span class=w> </span>-a
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>sudo<span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>'/ swap / s/^/#/'</span><span class=w> </span>/etc/fstab
</span></code></pre></div> </li> <li> <p>Install <code>curl</code> and <code>apt-transport-https</code></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>sudo<span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>apt-transport-https<span class=w> </span>curl
</span></code></pre></div> </li> <li> <p>Download the Google Cloud public signing key and add key to verify releases</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>curl<span class=w> </span>-s<span class=w> </span>https://packages.cloud.google.com/apt/doc/apt-key.gpg<span class=w> </span><span class=p>|</span><span class=w> </span>sudo<span class=w> </span>apt-key<span class=w> </span>add<span class=w> </span>-
</span></code></pre></div> </li> <li> <p>add kubernetes apt repo</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>cat<span class=w> </span><span class=s>&lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=s>deb https://apt.kubernetes.io/ kubernetes-xenial main</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=s>EOF</span>
</span></code></pre></div> </li> <li> <p>Install kubelet and kubeadm</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>sudo<span class=w> </span>apt-get<span class=w> </span>update
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>kubelet<span class=w> </span>kubeadm
</span></code></pre></div> </li> <li> <p><code>apt-mark hold</code> is used so that these packages will not be updated/removed automatically</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>sudo<span class=w> </span>apt-mark<span class=w> </span>hold<span class=w> </span>kubelet<span class=w> </span>kubeadm
</span></code></pre></div> </li> </ul> <hr> <h2 id=install-the-container-runtime-ie-containerd-on-master-and-worker-nodes>Install the <strong>container runtime</strong> i.e. <strong>containerd</strong> on master and worker nodes</h2> <p>To run containers in Pods, Kubernetes uses a <a href=https://kubernetes.io/docs/setup/production-environment/container-runtimes/ >container runtime</a>.</p> <p>By default, Kubernetes uses the <strong>Container Runtime Interface (CRI)</strong> to interface with your chosen container runtime.</p> <ul> <li> <p>Install container runtime - <strong>containerd</strong></p> <p>The first thing to do is configure the persistent loading of the necessary <code>containerd</code> modules. This forwarding IPv4 and letting iptables see bridged trafficis is done with the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>cat<span class=w> </span><span class=s>&lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=s>overlay</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=s>br_netfilter</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=s>EOF</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>sudo<span class=w> </span>modprobe<span class=w> </span>overlay
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>sudo<span class=w> </span>modprobe<span class=w> </span>br_netfilter
</span></code></pre></div> </li> <li> <p>Ensure <code>net.bridge.bridge-nf-call-iptables</code> is set to <code>1</code> in your sysctl config:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># sysctl params required by setup, params persist across reboots</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>cat<span class=w> </span><span class=s>&lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=s>net.bridge.bridge-nf-call-iptables  = 1</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=s>net.bridge.bridge-nf-call-ip6tables = 1</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=s>net.ipv4.ip_forward                 = 1</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=s>EOF</span>
</span></code></pre></div> </li> <li> <p>Apply sysctl params without reboot:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>sudo<span class=w> </span>sysctl<span class=w> </span>--system
</span></code></pre></div> </li> <li> <p>Install the necessary dependencies with:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>curl<span class=w> </span>gnupg2<span class=w> </span>software-properties-common<span class=w> </span>apt-transport-https<span class=w> </span>ca-certificates
</span></code></pre></div> </li> <li> <p>The <code>containerd.io</code> packages in DEB and RPM formats are distributed by Docker. Add the required GPG key with:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>curl<span class=w> </span>-fsSL<span class=w> </span>https://download.docker.com/linux/ubuntu/gpg<span class=w> </span><span class=p>|</span><span class=w> </span>sudo<span class=w> </span>apt-key<span class=w> </span>add<span class=w> </span>-
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>sudo<span class=w> </span>add-apt-repository<span class=w> </span><span class=s2>"deb [arch=amd64] https://download.docker.com/linux/ubuntu </span><span class=k>$(</span>lsb_release<span class=w> </span>-cs<span class=k>)</span><span class=s2> stable"</span>
</span></code></pre></div> <p>It's now time to Install and configure containerd:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>sudo<span class=w> </span>apt<span class=w> </span>update<span class=w> </span>-y
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>containerd.io
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>containerd<span class=w> </span>config<span class=w> </span>default<span class=w> </span><span class=p>|</span><span class=w> </span>sudo<span class=w> </span>tee<span class=w> </span>/etc/containerd/config.toml
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=c1># Reload the systemd daemon with</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>sudo<span class=w> </span>systemctl<span class=w> </span>daemon-reload
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=c1># Start containerd</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>sudo<span class=w> </span>systemctl<span class=w> </span>restart<span class=w> </span>containerd
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>sudo<span class=w> </span>systemctl<span class=w> </span><span class=nb>enable</span><span class=w> </span>--now<span class=w> </span>containerd
</span></code></pre></div> <p>You can verify <code>containerd</code> is running with the command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>sudo<span class=w> </span>systemctl<span class=w> </span>status<span class=w> </span>containerd
</span></code></pre></div> </li> </ul> <hr> <h2 id=configure-kubeadm-to-bootstrap-the-cluster>Configure kubeadm to bootstrap the cluster</h2> <p>You will start off by initializing only one master node. For this purpose, you choose <code>master1</code> to initialize our first control plane but you can also do the same in <code>master2</code>.</p> <ul> <li> <p>SSH into <strong>master1</strong> machine</p> </li> <li> <p>Switch to root user: <code>sudo su</code></p> <div class="admonition danger"> <p class=admonition-title>Configuring the kubelet cgroup driver</p> <p>From 1.22 onwards, if you do not set the <code>cgroupDriver</code> field under <code>KubeletConfiguration</code>, <code>kubeadm</code> will default it to <code>systemd</code>. So you do not need to do anything here by default but if you want you change it you can refer to <a href=https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/configure-cgroup-driver/ >this documentation</a>.</p> </div> </li> <li> <p>Execute the below command to initialize the cluster:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>kubeadm<span class=w> </span>config<span class=w> </span>images<span class=w> </span>pull
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>kubeadm<span class=w> </span>init<span class=w> </span>--control-plane-endpoint
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=s2>"LOAD_BALANCER_IP_OR_HOSTNAME:LOAD_BALANCER_PORT"</span><span class=w> </span>--upload-certs<span class=w> </span>--pod-network-cidr<span class=o>=</span><span class=m>10</span>.244.0.0/16
</span></code></pre></div> <p>Here, you can use either the IP address or the hostname of the loadbalancer in place of <load_balancer_ip_or_hostname>. You have not enabled the hostname of the server, i.e. <code>loadbalancer</code> as the LOAD_BALANCER_IP_OR_HOSTNAME that is visible from the <strong>master1</strong> node. so instead of using not resolvable hostnames across your network, you will be using the IP address of the Loadbalancer server.</load_balancer_ip_or_hostname></p> <p>The <load_balancer_port> is the front end configuration port defined in HAPROXY configuration. For this, you have kept the port as <strong>6443</strong> which is the default <code>apiserver</code> port.</load_balancer_port></p> <div class="admonition note"> <p class=admonition-title>Important Note</p> <p><code>--pod-network-cidr</code> value depends upon what CNI plugin you going to use so need to be very careful while setting this CIDR values. In our case, you are going to use <strong>Flannel</strong> CNI network plugin so you will use: <code>--pod-network-cidr=10.244.0.0/16</code>. If you are opted to use <strong>Calico</strong> CNI network plugin then you need to use: <code>--pod-network-cidr=192.168.0.0/16</code> and if you are opted to use <strong>Weave Net</strong> no need to pass this parameter.</p> </div> <p>For example, our <code>Flannel</code> CNI network plugin based kubeadm init command with <em>loadbalancer node</em> with internal IP: <code>192.168.0.167</code> look like below:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>kubeadm<span class=w> </span>config<span class=w> </span>images<span class=w> </span>pull
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>kubeadm<span class=w> </span>init<span class=w> </span>--control-plane-endpoint<span class=w> </span><span class=s2>"192.168.0.167:6443"</span><span class=w> </span>--upload-certs<span class=w> </span>--pod-network-cidr<span class=o>=</span><span class=m>10</span>.244.0.0/16
</span></code></pre></div> <p>Save the output in some secure file for future use. This will show an unique token to join the control plane. The output from <code>kubeadm init</code> should looks like below:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>Your<span class=w> </span>Kubernetes<span class=w> </span>control-plane<span class=w> </span>has<span class=w> </span>initialized<span class=w> </span>successfully!
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>To<span class=w> </span>start<span class=w> </span>using<span class=w> </span>your<span class=w> </span>cluster,<span class=w> </span>you<span class=w> </span>need<span class=w> </span>to<span class=w> </span>run<span class=w> </span>the<span class=w> </span>following<span class=w> </span>as<span class=w> </span>a<span class=w> </span>regular<span class=w> </span>user:
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>mkdir<span class=w> </span>-p<span class=w> </span><span class=nv>$HOME</span>/.kube
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>sudo<span class=w> </span>cp<span class=w> </span>-i<span class=w> </span>/etc/kubernetes/admin.conf<span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>sudo<span class=w> </span>chown<span class=w> </span><span class=k>$(</span>id<span class=w> </span>-u<span class=k>)</span>:<span class=k>$(</span>id<span class=w> </span>-g<span class=k>)</span><span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>Alternatively,<span class=w> </span><span class=k>if</span><span class=w> </span>you<span class=w> </span>are<span class=w> </span>the<span class=w> </span>root<span class=w> </span>user,<span class=w> </span>you<span class=w> </span>can<span class=w> </span>run:
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=nb>export</span><span class=w> </span><span class=nv>KUBECONFIG</span><span class=o>=</span>/etc/kubernetes/admin.conf
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>You<span class=w> </span>should<span class=w> </span>now<span class=w> </span>deploy<span class=w> </span>a<span class=w> </span>pod<span class=w> </span>network<span class=w> </span>to<span class=w> </span>the<span class=w> </span>cluster.
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>Run<span class=w> </span><span class=s2>"kubectl apply -f [podnetwork].yaml"</span><span class=w> </span>with<span class=w> </span>one<span class=w> </span>of<span class=w> </span>the<span class=w> </span>options<span class=w> </span>listed<span class=w> </span>at:
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>https://kubernetes.io/docs/concepts/cluster-administration/addons/
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>You<span class=w> </span>can<span class=w> </span>now<span class=w> </span>join<span class=w> </span>any<span class=w> </span>number<span class=w> </span>of<span class=w> </span>the<span class=w> </span>control-plane<span class=w> </span>node<span class=w> </span>running<span class=w> </span>the<span class=w> </span>following
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=nb>command</span><span class=w> </span>on<span class=w> </span>each<span class=w> </span>worker<span class=w> </span>nodes<span class=w> </span>as<span class=w> </span>root:
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb<span class=w> </span><span class=se>\</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e15ee3
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=w>    </span>7ab9834567333b939458a5bfb5<span class=w> </span><span class=se>\</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=w>    </span>--control-plane<span class=w> </span>--certificate-key<span class=w> </span>824d9a0e173a810416b4bca7038fb33b616108c17abcbc5eaef8651f11e3d146
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a>Please<span class=w> </span>note<span class=w> </span>that<span class=w> </span>the<span class=w> </span>certificate-key<span class=w> </span>gives<span class=w> </span>access<span class=w> </span>to<span class=w> </span>cluster<span class=w> </span>sensitive<span class=w> </span>data,<span class=w> </span>keep
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a>it<span class=w> </span>secret!
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a>As<span class=w> </span>a<span class=w> </span>safeguard,<span class=w> </span>uploaded-certs<span class=w> </span>will<span class=w> </span>be<span class=w> </span>deleted<span class=w> </span><span class=k>in</span><span class=w> </span>two<span class=w> </span>hours<span class=p>;</span><span class=w> </span>If<span class=w> </span>necessary,<span class=w> </span>you
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a>can<span class=w> </span>use<span class=w> </span><span class=s2>"kubeadm init phase upload-certs --upload-certs"</span><span class=w> </span>to<span class=w> </span>reload<span class=w> </span>certs<span class=w> </span>afterward.
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a>
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a>Then<span class=w> </span>you<span class=w> </span>can<span class=w> </span>join<span class=w> </span>any<span class=w> </span>number<span class=w> </span>of<span class=w> </span>worker<span class=w> </span>nodes<span class=w> </span>by<span class=w> </span>running<span class=w> </span>the<span class=w> </span>following<span class=w> </span>on<span class=w> </span>each<span class=w> </span>as
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a>root:
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a>
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb<span class=w> </span><span class=se>\</span>
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e15ee37ab9834567333b939458a5bfb5
</span></code></pre></div> <p>The output consists of 3 major tasks:</p> <p>A. Setup <code>kubeconfig</code> using on current master node: As you are running as <code>root</code> user so you need to run the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nb>export</span><span class=w> </span><span class=nv>KUBECONFIG</span><span class=o>=</span>/etc/kubernetes/admin.conf
</span></code></pre></div> <p>We need to run the below commands as a normal user to use the kubectl from terminal.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>mkdir<span class=w> </span>-p<span class=w> </span><span class=nv>$HOME</span>/.kube
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>sudo<span class=w> </span>cp<span class=w> </span>-i<span class=w> </span>/etc/kubernetes/admin.conf<span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>sudo<span class=w> </span>chown<span class=w> </span><span class=k>$(</span>id<span class=w> </span>-u<span class=k>)</span>:<span class=k>$(</span>id<span class=w> </span>-g<span class=k>)</span><span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span></code></pre></div> <p>Now the machine is initialized as master.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Kubeadm signs the certificate in the admin.conf to have <code>Subject: O = system:masters, CN = kubernetes-admin. system:masters</code> is a break-glass, super user group that bypasses the authorization layer (e.g. RBAC). Do not share the admin.conf file with anyone and instead grant users custom permissions by generating them a kubeconfig file using the <code>kubeadm kubeconfig user</code> command.</p> </div> <p>B. Setup a new control plane (master) i.e. <code>master2</code> by running following command on <strong>master2</strong> node:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb<span class=w> </span><span class=se>\</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e1
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w>        </span>5ee37ab9834567333b939458a5bfb5<span class=w> </span><span class=se>\</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w>    </span>--control-plane<span class=w> </span>--certificate-key<span class=w> </span>824d9a0e173a810416b4bca7038fb33b616108c17abcbc5eaef8651f11e3d146
</span></code></pre></div> <p>C. Join worker nodes running following command on individual worker nodes:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e15ee37ab9834567333b939458a5bfb5
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Important Note</p> <p><strong>Your output will be different than what is provided here. While performing the rest of the demo, ensure that you are executing the command provided by your output and dont copy and paste from here.</strong></p> </div> <p>If you do not have the token, you can get it by running the following command on the control-plane node:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>kubeadm<span class=w> </span>token<span class=w> </span>list
</span></code></pre></div> <p>The output is similar to this:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>TOKEN<span class=w>     </span>TTL<span class=w>  </span>EXPIRES<span class=w>      </span>USAGES<span class=w>           </span>DESCRIPTION<span class=w>            </span>EXTRA<span class=w> </span>GROUPS
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>8ewj1p...<span class=w> </span>23h<span class=w>  </span><span class=m>2018</span>-06-12<span class=w>   </span>authentication,<span class=w>  </span>The<span class=w> </span>default<span class=w> </span>bootstrap<span class=w>  </span>system:
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=w>                            </span>signing<span class=w>          </span>token<span class=w> </span>generated<span class=w> </span>by<span class=w>     </span>bootstrappers:
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=w>                                            </span><span class=s1>'kubeadm init'</span>.<span class=w>         </span>kubeadm:
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=w>                                                                    </span>default-node-token
</span></code></pre></div> <p>If you missed the join command, execute the following command <code>kubeadm token create --print-join-command</code> in the master node to recreate the token with the join command.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>root@master:~$<span class=w> </span>kubeadm<span class=w> </span>token<span class=w> </span>create<span class=w> </span>--print-join-command
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>10</span>.2.0.4:6443<span class=w> </span>--token<span class=w> </span>xyzeyi.wxer3eg9vj8hcpp2<span class=w> </span><span class=se>\</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>--discovery-token-ca-cert-hash<span class=w> </span>sha256:ccfc92b2a31b002c3151cdbab77ff4dc32ef13b213fa3a9876e126831c76f7fa
</span></code></pre></div> <p>By default, tokens expire after 24 hours. If you are joining a node to the cluster after the current token has expired, you can create a new token by running the following command on the control-plane node:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>kubeadm<span class=w> </span>token<span class=w> </span>create
</span></code></pre></div> <p>The output is similar to this: <code>5didvk.d09sbcov8ph2amjw</code></p> <p>We can use this new token to join:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>kubeadm<span class=w> </span>join<span class=w> </span>&lt;master-ip&gt;:&lt;master-port&gt;<span class=w> </span>--token<span class=w> </span>&lt;token&gt;<span class=w> </span><span class=se>\</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:&lt;hash&gt;
</span></code></pre></div> </li> </ul> <hr> <ul> <li> <p>SSH into <code>master2</code></p> </li> <li> <p>Switch to root user:<code>sudo su</code></p> </li> <li> <p>Check the command provided by the output of <code>master1</code>:</p> <p>You can now use the below command to add another control-plane node(master) to the control plane:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e15ee3
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=w>    </span>7ab9834567333b939458a5bfb5<span class=w> </span><span class=se>\</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=w>    </span>--control-plane<span class=w> </span>--certificate-key<span class=w> </span>824d9a0e173a810416b4bca7038fb33b616108c17abcbc5eaef8651f11e3d146
</span></code></pre></div> </li> <li> <p>Execute the kubeadm join command for control plane on <code>master2</code></p> <p>Your output should look like:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>This<span class=w> </span>node<span class=w> </span>has<span class=w> </span>joined<span class=w> </span>the<span class=w> </span>cluster<span class=w> </span>and<span class=w> </span>a<span class=w> </span>new<span class=w> </span>control<span class=w> </span>plane<span class=w> </span>instance<span class=w> </span>was<span class=w> </span>created:
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>*<span class=w> </span>Certificate<span class=w> </span>signing<span class=w> </span>request<span class=w> </span>was<span class=w> </span>sent<span class=w> </span>to<span class=w> </span>apiserver<span class=w> </span>and<span class=w> </span>approval<span class=w> </span>was<span class=w> </span>received.
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>*<span class=w> </span>The<span class=w> </span>Kubelet<span class=w> </span>was<span class=w> </span>informed<span class=w> </span>of<span class=w> </span>the<span class=w> </span>new<span class=w> </span>secure<span class=w> </span>connection<span class=w> </span>details.
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>*<span class=w> </span>Control<span class=w> </span>plane<span class=w> </span><span class=o>(</span>master<span class=o>)</span><span class=w> </span>label<span class=w> </span>and<span class=w> </span>taint<span class=w> </span>were<span class=w> </span>applied<span class=w> </span>to<span class=w> </span>the<span class=w> </span>new<span class=w> </span>node.
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>*<span class=w> </span>The<span class=w> </span>Kubernetes<span class=w> </span>control<span class=w> </span>plane<span class=w> </span>instances<span class=w> </span>scaled<span class=w> </span>up.
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>*<span class=w> </span>A<span class=w> </span>new<span class=w> </span>etcd<span class=w> </span>member<span class=w> </span>was<span class=w> </span>added<span class=w> </span>to<span class=w> </span>the<span class=w> </span>local/stacked<span class=w> </span>etcd<span class=w> </span>cluster.
</span></code></pre></div> </li> </ul> <p>Now that you have initialized both the masters - you can now work on bootstrapping the worker nodes.</p> <ul> <li> <p>SSH into <strong>worker1</strong> and <strong>worker2</strong></p> </li> <li> <p>Switch to root user on both the machines: <code>sudo su</code></p> </li> <li> <p>Check the output given by the init command on <strong>master1</strong> to join worker node:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>kubeadm<span class=w> </span>join<span class=w> </span><span class=m>192</span>.168.0.167:6443<span class=w> </span>--token<span class=w> </span>cnslau.kd5fjt96jeuzymzb<span class=w> </span><span class=se>\</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=w>    </span>--discovery-token-ca-cert-hash<span class=w> </span>sha256:871ab3f050bc9790c977daee9e44cf52e15ee37ab9834567333b939458a5bfb5
</span></code></pre></div> </li> <li> <p>Execute the above command on both the nodes:</p> </li> <li> <p>Your output should look like:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>This<span class=w> </span>node<span class=w> </span>has<span class=w> </span>joined<span class=w> </span>the<span class=w> </span>cluster:
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>*<span class=w> </span>Certificate<span class=w> </span>signing<span class=w> </span>request<span class=w> </span>was<span class=w> </span>sent<span class=w> </span>to<span class=w> </span>apiserver<span class=w> </span>and<span class=w> </span>a<span class=w> </span>response<span class=w> </span>was<span class=w> </span>received.
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>*<span class=w> </span>The<span class=w> </span>Kubelet<span class=w> </span>was<span class=w> </span>informed<span class=w> </span>of<span class=w> </span>the<span class=w> </span>new<span class=w> </span>secure<span class=w> </span>connection<span class=w> </span>details.
</span></code></pre></div> </li> </ul> <hr> <h2 id=configure-kubeconfig-on-loadbalancer-node>Configure kubeconfig on loadbalancer node</h2> <p>Now that you have configured the master and the worker nodes, its now time to configure Kubeconfig (<code>.kube</code>) on the loadbalancer node. It is completely up to you if you want to use the loadbalancer node to setup kubeconfig. kubeconfig can also be setup externally on a separate machine which has access to loadbalancer node. For the purpose of this demo you will use loadbalancer node to host kubeconfig and <code>kubectl</code>.</p> <ul> <li> <p>SSH into <code>loadbalancer</code> node</p> </li> <li> <p>Switch to root user: <code>sudo su</code></p> </li> <li> <p>Create a directory: .kube at $HOME of root user</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>mkdir<span class=w> </span>-p<span class=w> </span><span class=nv>$HOME</span>/.kube
</span></code></pre></div> </li> <li> <p>SCP configuration file from any one <strong>master</strong> node to <strong>loadbalancer</strong> node</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>scp<span class=w> </span>master1:/etc/kubernetes/admin.conf<span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Important Note</p> <p>If you havent setup ssh connection between master node and loadbalancer, you can manually copy the contents of the file <code>/etc/kubernetes/admin.conf</code> from <code>master1</code> node and then paste it to <code>$HOME/.kube/config</code> file on the loadbalancer node. Ensure that the kubeconfig file path is <strong><code>$HOME/.kube/config</code></strong> on the loadbalancer node.</p> </div> </li> <li> <p>Provide appropriate ownership to the copied file</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>chown<span class=w> </span><span class=k>$(</span>id<span class=w> </span>-u<span class=k>)</span>:<span class=k>$(</span>id<span class=w> </span>-g<span class=k>)</span><span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span></code></pre></div> </li> </ul> <hr> <h2 id=install-kubectl>Install <strong>kubectl</strong></h2> <ul> <li> <p>Install kubectl binary</p> <p><strong>kubectl</strong>: the command line util to talk to your cluster.</p> <div class="language-text highlight"><pre><span></span><code>snap install kubectl --classic
</code></pre></div> <p>This outputs:</p> <div class="language-text highlight"><pre><span></span><code>kubectl 1.26.1 from Canonical installed
</code></pre></div> </li> <li> <p>Verify the cluster</p> <div class="language-text highlight"><pre><span></span><code>kubectl get nodes

NAME STATUS ROLES AGE VERSION
master1 NotReady control-plane,master 21m v1.26.1
master2 NotReady control-plane,master 15m v1.26.1
worker1 Ready &lt;none&gt; 9m17s v1.26.1
worker2 Ready &lt;none&gt; 9m25s v1.26.1
</code></pre></div> </li> </ul> <hr> <h2 id=install-cni-network-plugin>Install CNI network plugin</h2> <h3 id=cni-overview>CNI overview</h3> <p>Managing a network where containers can interoperate efficiently is very important. Kubernetes has adopted the Container Network Interface(CNI) specification for managing network resources on a cluster. This relatively simple specification makes it easy for Kubernetes to interact with a wide range of CNI-based software solutions. Using this CNI plugin allows Kubernetes pods to have the same IP address inside the pod as they do on the VPC network. Make sure the configuration corresponds to the Pod CIDR specified in the <code>kubeadm</code> configuration file if applicable.</p> <p>You must deploy a CNI based Pod network add-on so that your Pods can communicate with each other. Cluster DNS (CoreDNS) will not start up before a network is installed. To verify you can run this command: <code>kubectl get po -n kube-system</code>:</p> <p>You should see the following output. You will see the two <code>coredns-*</code> pods in a pending state. It is the expected behavior. Once we install the network plugin, it will be in a Running state.</p> <p>Output Example:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a>root@loadbalancer:~$<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>po<span class=w> </span>-n<span class=w> </span>kube-system
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=w> </span>NAME<span class=w>                               </span>READY<span class=w>  </span>STATUS<span class=w>   </span>RESTARTS<span class=w>  </span>AGE
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>coredns-558bd4d5db-5jktc<span class=w>             </span><span class=m>0</span>/1<span class=w>   </span>Pending<span class=w>   </span><span class=m>0</span><span class=w>        </span>10m
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>coredns-558bd4d5db-xdc5x<span class=w>             </span><span class=m>0</span>/1<span class=w>   </span>Pending<span class=w>   </span><span class=m>0</span><span class=w>        </span>10m
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>etcd-master1<span class=w>                         </span><span class=m>1</span>/1<span class=w>   </span>Running<span class=w>   </span><span class=m>0</span><span class=w>        </span>11m
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a>kube-apiserver-master1<span class=w>               </span><span class=m>1</span>/1<span class=w>   </span>Running<span class=w>   </span><span class=m>0</span><span class=w>        </span>11m
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a>kube-controller-manager-master1<span class=w>      </span><span class=m>1</span>/1<span class=w>   </span>Running<span class=w>   </span><span class=m>0</span><span class=w>        </span>11m
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a>kube-proxy-5jfh5<span class=w>                     </span><span class=m>1</span>/1<span class=w>   </span>Running<span class=w>   </span><span class=m>0</span><span class=w>        </span>10m
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a>kube-scheduler-master1<span class=w>               </span><span class=m>1</span>/1<span class=w>   </span>Running<span class=w>   </span><span class=m>0</span><span class=w>        </span>11m
</span></code></pre></div> <h3 id=supported-cni-options>Supported CNI options</h3> <p>To read more about the currently supported base CNI solutions for Kubernetes <a href=https://kubernetes.io/docs/concepts/cluster-administration/networking/ >read here</a> and also <a href=https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network>read this</a>.</p> <p>The below command can be run on the Loadbalancer node to install the CNI plugin:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>https://github.com/coreos/flannel/raw/master/Documentation/kube-flannel.yml
</span></code></pre></div> <p>As you had passed <code>--pod-network-cidr=10.244.0.0/16</code> with <code>kubeadm init</code> so this should work for <strong>Flannel</strong> CNI.</p> <div class="admonition tip"> <p class=admonition-title>Using Other CNI Options</p> <p>For <strong>Calico</strong> CNI plugin to work correctly, you need to pass <code>--pod-network-cidr=192.168.0.0/16</code> with <code>kubeadm init</code> and then you can run: <code>kubectl apply -f https://docs.projectcalico.org/v3.8/manifests/calico.yaml</code></p> </div> <hr> <p>For <strong>Weave Net</strong> CNI plugin to work correctly, you <strong>don't</strong> need to pass <code>--pod-network-cidr</code> with <code>kubeadm init</code> and then you can run: <code>kubectl apply -f "https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\n')"</code></p> <p>Dual Network:</p> <p>It is <strong>highly recommended</strong> to follow an internal/external network layout for your cluster, as showed in this diagram:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/network-layout.png data-desc-position=bottom><img alt="Dual Network Diagram" src=../../images/network-layout.png></a></p> <p>To enable this just give two different names to the internal and external interface, according to your distro of choiche naming scheme:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a>external_interface:<span class=w> </span>eth0
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>internal_interface:<span class=w> </span>eth1
</span></code></pre></div> <p>Also you can decide here what CIDR should your cluster use</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a>cluster_cidr:<span class=w> </span><span class=m>10</span>.43.0.0/16
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>service_cidr:<span class=w> </span><span class=m>10</span>.44.0.0/16
</span></code></pre></div> <p>Once you successfully installed the <strong>Flannel</strong> CNI component to your cluster. You can now verify your HA cluster running:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a>kubectl<span class=w> </span>get<span class=w> </span>nodes
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>NAME<span class=w>      </span>STATUS<span class=w>   </span>ROLES<span class=w>                    </span>AGE<span class=w>   </span>VERSION
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a>master1<span class=w>   </span>Ready<span class=w>    </span>control-plane,master<span class=w>     </span>22m<span class=w>   </span>v1.26.1
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>master2<span class=w>   </span>Ready<span class=w>    </span>control-plane,master<span class=w>     </span>17m<span class=w>   </span>v1.26.1
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>worker1<span class=w>   </span>Ready<span class=w>    </span>&lt;none&gt;<span class=w>                   </span>10m<span class=w>   </span>v1.26.1
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a>worker2<span class=w>   </span>Ready<span class=w>    </span>&lt;none&gt;<span class=w>                   </span>10m<span class=w>   </span>v1.26.1
</span></code></pre></div> <hr> <h2 id=deploy-a-sample-nginx-application-from-one-of-the-master-nodes>Deploy A Sample Nginx Application From one of the master nodes</h2> <p>Now that we have all the components to make the cluster and applications work, let's deploy a sample Nginx application and see if we can access it over a <a href=https://kubernetes.io/docs/concepts/services-networking/service/#nodeport>NodePort</a> that has port range of <em>30000-32767</em>.</p> <p>The below command can be run on:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a>kubectl<span class=w> </span>run<span class=w> </span>nginx<span class=w> </span>--image<span class=o>=</span>nginx<span class=w> </span>--port<span class=o>=</span><span class=m>80</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>kubectl<span class=w> </span>expose<span class=w> </span>pod<span class=w> </span>nginx<span class=w> </span>--port<span class=o>=</span><span class=m>80</span><span class=w> </span>--type<span class=o>=</span>NodePort
</span></code></pre></div> <p>To check which NodePort is opened and running the Nginx run:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a>kubectl<span class=w> </span>get<span class=w> </span>svc
</span></code></pre></div> <p>The output will show:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/running_services.png data-desc-position=bottom><img alt="Running Services" src=../../images/running_services.png></a></p> <p>Once the deployment is up, you should be able to access the Nginx home page on the allocated NodePort from either of the worker nodes' Floating IP.</p> <p>To check which worker node is serving <code>nginx</code>, you can check <strong>NODE</strong> column running the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>--all-namespaces<span class=w> </span>--output<span class=w> </span>wide
</span></code></pre></div> <p><strong>OR,</strong></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>-A<span class=w> </span>-o<span class=w> </span>wide
</span></code></pre></div> <p>This will show like below:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/nginx-pod-worker-node.png data-desc-position=bottom><img alt="Nginx Pod and Worker" src=../../images/nginx-pod-worker-node.png></a></p> <p>Go to browser, visit <code>http://&lt;Worker-Floating-IP&gt;:&lt;NodePort&gt;</code> i.e. <a href=http://128.31.25.246:32713>http://128.31.25.246:32713</a> to check the nginx default page. Here <code>Worker_Floating-IP</code> corresponds to the Floating IP of the <code>nginx</code> pod running worker node i.e. <code>worker2</code>.</p> <p>For your example,</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/nginx_page.png data-desc-position=bottom><img alt="nginx default page" src=../../images/nginx_page.png></a></p> <hr> <h2 id=deploy-a-k8s-dashboard>Deploy A K8s Dashboard</h2> <p>You will going to setup <a href=https://github.com/skooner-k8s/skooner>K8dash/Skooner</a> to view a dashboard that shows all your K8s cluster components.</p> <ul> <li> <p>SSH into <code>loadbalancer</code> node</p> </li> <li> <p>Switch to root user: <code>sudo su</code></p> </li> <li> <p>Apply available deployment by running the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>https://raw.githubusercontent.com/skooner-k8s/skooner/master/kubernetes-skooner-nodeport.yaml
</span></code></pre></div> <p>This will map Skooner port <strong>4654</strong> to a randomly selected port on the running node.</p> <p>The assigned NodePort can be found running:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a>kubectl<span class=w> </span>get<span class=w> </span>svc<span class=w> </span>--namespace<span class=o>=</span>kube-system
</span></code></pre></div> <p><strong>OR,</strong></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a>kubectl<span class=w> </span>get<span class=w> </span>po,svc<span class=w> </span>-n<span class=w> </span>kube-system
</span></code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/skooner_port.png data-desc-position=bottom><img alt="Skooner Service Port" src=../../images/skooner_port.png></a></p> <p>To check which worker node is serving <code>skooner-*</code>, you can check <strong>NODE</strong> column running the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>--all-namespaces<span class=w> </span>--output<span class=w> </span>wide
</span></code></pre></div> <p><strong>OR,</strong></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>-A<span class=w> </span>-o<span class=w> </span>wide
</span></code></pre></div> <p>This will show like below:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/skooner-pod-worker-node.png data-desc-position=bottom><img alt="Skooner Pod and Worker" src=../../images/skooner-pod-worker-node.png></a></p> <p>Go to browser, visit <code>http://&lt;Worker-Floating-IP&gt;:&lt;NodePort&gt;</code> i.e. <a href=http://128.31.25.246:30495>http://128.31.25.246:30495</a> to check the skooner dashboard page. Here <code>Worker_Floating-IP</code> corresponds to the Floating IP of the <code>skooner-*</code> pod running worker node i.e. <code>worker2</code>.</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../images/skooner-dashboard.png data-desc-position=bottom><img alt="Skooner Dashboard" src=../../images/skooner-dashboard.png></a></p> </li> </ul> <p>Setup the <strong>Service Account Token</strong> to access the Skooner Dashboard:</p> <p>The first (and easiest) option is to create a dedicated service account. Run the following commands:</p> <ul> <li> <p>Create the service account in the current namespace (we assume default)</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a>kubectl<span class=w> </span>create<span class=w> </span>serviceaccount<span class=w> </span>skooner-sa
</span></code></pre></div> </li> <li> <p>Give that service account root on the cluster</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a>kubectl<span class=w> </span>create<span class=w> </span>clusterrolebinding<span class=w> </span>skooner-sa<span class=w> </span>--clusterrole<span class=o>=</span>cluster-admin<span class=w> </span>--serviceaccount<span class=o>=</span>default:skooner-sa
</span></code></pre></div> </li> <li> <p>Create a secret that was created to hold the token for the SA:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a><span class=s>apiVersion: v1</span>
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=s>kind: Secret</span>
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=s>metadata:</span>
</span><span id=__span-59-5><a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=s>    name: skooner-sa-token</span>
</span><span id=__span-59-6><a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a><span class=s>    annotations:</span>
</span><span id=__span-59-7><a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=s>        kubernetes.io/service-account.name: skooner-sa</span>
</span><span id=__span-59-8><a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a><span class=s>type: kubernetes.io/service-account-token</span>
</span><span id=__span-59-9><a id=__codelineno-59-9 name=__codelineno-59-9 href=#__codelineno-59-9></a><span class=s>EOF</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Information</p> <p>Since 1.22, this type of Secret is no longer used to mount credentials into Pods, and obtaining tokens via the <a href=https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/ >TokenRequest API</a> is recommended instead of using service account token Secret objects. Tokens obtained from the <em>TokenRequest API</em> are more secure than ones stored in Secret objects, because they have a bounded lifetime and are not readable by other API clients. You can use the <code>kubectl create token</code> command to obtain a token from the TokenRequest API. For example: <code>kubectl create token skooner-sa</code>, where <code>skooner-sa</code> is service account name.</p> </div> </li> <li> <p>Find the secret that was created to hold the token for the SA</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a>kubectl<span class=w> </span>get<span class=w> </span>secrets
</span></code></pre></div> </li> <li> <p>Show the contents of the secret to extract the token</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a>kubectl<span class=w> </span>describe<span class=w> </span>secret<span class=w> </span>skooner-sa-token
</span></code></pre></div> </li> </ul> <p>Copy the <strong>token</strong> value from the secret detail and enter it into the login screen to access the dashboard.</p> <h2 id=watch-demo-video-showing-how-to-setup-the-cluster>Watch Demo Video showing how to setup the cluster</h2> <p>Here's a <a href="https://drive.google.com/file/d/1mALftMHEUkjQ7lK6oJ6S_tiY59Q0JASY/view?usp=sharing">recorded demo video</a> on how to setup HA K8s cluster using <code>kubeadm</code> as explained above.</p> <hr> <h2 id=very-important-certificates-renewal>Very Important: Certificates Renewal</h2> <p>Client certificates generated by <code>kubeadm</code> expire after one year unless the Kubernetes version is upgraded or the certificates are manually renewed.</p> <p>To renew certificates manually, you can use the kubeadm certs renew command with the appropriate command line options. After running the command, you should restart the control plane Pods.</p> <p><code>kubeadm certs renew</code> can renew any specific certificate or, with the subcommand all, it can renew all of them, as shown below:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>kubeadm<span class=w> </span>certs<span class=w> </span>renew<span class=w> </span>all
</span></code></pre></div> <p>Once renewing certificates is done. You must restart the <code>kube-apiserver</code>, <code>kube-controller-manager</code>, <code>kube-scheduler</code> and <code>etcd</code>, so that they can use the new certificates by running:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a>systemctl<span class=w> </span>restart<span class=w> </span>kubelet
</span></code></pre></div> <p>Then, update the new kube config file:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=nb>export</span><span class=w> </span><span class=nv>KUBECONFIG</span><span class=o>=</span>/etc/kubernetes/admin.conf
</span><span id=__span-64-2><a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>sudo<span class=w> </span>cp<span class=w> </span>-i<span class=w> </span>/etc/kubernetes/admin.conf<span class=w> </span><span class=nv>$HOME</span>/.kube/config
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Don't Forget to Update the older kube config file</p> <p>Update wherever you are using the older kube config to connect with the cluster.</p> </div> <h2 id=clean-up>Clean Up</h2> <ul> <li> <p>To view the Cluster info:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a>kubectl<span class=w> </span>cluster-info
</span></code></pre></div> </li> <li> <p>To delete your local references to the cluster:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a>kubectl<span class=w> </span>config<span class=w> </span>delete-cluster
</span></code></pre></div> </li> </ul> <h3 id=how-to-remove-the-node>How to Remove the node?</h3> <p>Talking to the control-plane node with the appropriate credentials, run:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a>kubectl<span class=w> </span>drain<span class=w> </span>&lt;node<span class=w> </span>name&gt;<span class=w> </span>--delete-emptydir-data<span class=w> </span>--force<span class=w> </span>--ignore-daemonsets
</span></code></pre></div> <ul> <li> <p>Before removing the node, reset the state installed by kubeadm:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a>kubeadm<span class=w> </span>reset
</span></code></pre></div> <p>The reset process does not reset or clean up iptables rules or IPVS tables. If you wish to reset iptables, you must do so manually:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a>iptables<span class=w> </span>-F<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>iptables<span class=w> </span>-t<span class=w> </span>nat<span class=w> </span>-F<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>iptables<span class=w> </span>-t<span class=w> </span>mangle<span class=w> </span>-F<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>iptables<span class=w> </span>-X
</span></code></pre></div> <p>If you want to reset the IPVS tables, you must run the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a>ipvsadm<span class=w> </span>-C
</span></code></pre></div> </li> <li> <p>Now remove the node:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a>kubectl<span class=w> </span>delete<span class=w> </span>node<span class=w> </span>&lt;node<span class=w> </span>name&gt;
</span></code></pre></div> </li> </ul> <p>If you wish to start over, run <code>kubeadm init</code> or <code>kubeadm join</code> with the appropriate arguments.</p> <hr> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 25, 2026 15:02:40 UTC">February 25, 2026</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <aside class=footer-left> <a href=http://www.bu.edu/tech/services/research/ title="Boston University" target=_blank> <img alt="Boston University Logo" src=https://nerc-project.github.io/nerc-docs/assets/images/boston-university-logo.png> </a> </aside> <aside class=footer-center> <a href=http://rc.fas.harvard.edu title="Harvard University" target=_blank> <img alt="Harvard University Logo" src=https://nerc-project.github.io/nerc-docs/assets/images/harvard-university_logo.png> </a> </aside> <aside class=footer-center> <a href=https://www.mghpcc.org/ title=MGHPCC target=_blank> <img alt="MGHPCC Logo" src=https://nerc-project.github.io/nerc-docs/assets/images/MGHPCC_logo.png> </a> </aside> <aside class=footer-right> <a href=https://massopen.cloud/ title="MOC Alliance" target=_blank> <img alt="MOC Alliance" src=https://massopen.cloud/wp-content/uploads/2022/07/MOCwordmark_RGB_small.png style="width: 80%"> </a> </aside> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../../../..", "features": ["content.action.edit", "content.code.copy", "content.code.annotate", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tracking", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.path", "search.highlight", "search.share", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../../../javascripts/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>